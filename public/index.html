<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    body {background-color: #e7ebed}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b; min-height: 16.0px}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s7 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
    span.s8 {font-kerning: none; color: #4d5055; background-color: #ecf1f7; -webkit-text-stroke: 0px #4d5055}
    span.s9 {font-kerning: none; color: #6f0ec3; background-color: #ecf1f7; -webkit-text-stroke: 0px #6f0ec3}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #0e6e6d; background-color: #ecf1f7; -webkit-text-stroke: 0px #0e6e6d}
    span.s12 {font-kerning: none; color: #a4450b; background-color: #ecf1f7; -webkit-text-stroke: 0px #a4450b}
    span.s13 {font-kerning: none; color: #137646; background-color: #ecf1f7; -webkit-text-stroke: 0px #137646}
    span.s14 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">AI Bible Reading Plan Generator</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Tailwind CSS CDN --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Custom color configuration</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>tailwind.config = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>theme: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>extend: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>colors: {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">// REVERTED TO ORIGINAL VIBRANT COLORS</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">'primary-teal'</span><span class="s1">: </span><span class="s7">'#008080'</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">'secondary-gold'</span><span class="s1">: </span><span class="s7">'#FFD700'</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">'dark-teal'</span><span class="s1">: </span><span class="s7">'#006666'</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">'light-gray'</span><span class="s1">: </span><span class="s7">'#FAFAFA'</span><span class="s1">, </span><span class="s8">// Softer background</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>fontFamily: {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">// Using system font stack (San Francisco/Segoe UI/Roboto)</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span>sans: [</span><span class="s1">'-apple-system'</span><span class="s4">, </span><span class="s1">'BlinkMacSystemFont'</span><span class="s4">, </span><span class="s1">'"Segoe UI"'</span><span class="s4">, </span><span class="s1">'Roboto'</span><span class="s4">, </span><span class="s1">'Helvetica'</span><span class="s4">, </span><span class="s1">'Arial'</span><span class="s4">, </span><span class="s1">'sans-serif'</span><span class="s4">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- html2canvas for screenshot functionality --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Firebase Imports (Required boilerplate) --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Global variables</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.currentPlan = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.currentPlanDetails = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.db = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.auth = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.userId = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> appId = </span><span class="s9">typeof</span><span class="s1"> __app_id !== </span><span class="s7">'undefined'</span><span class="s1"> ? __app_id : </span><span class="s7">'default-app-id'</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s9">import</span><span class="s4"> { initializeApp, setLogLevel } </span><span class="s9">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">import</span><span class="s1"> { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } </span><span class="s9">from</span><span class="s1"> </span><span class="s7">"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"</span><span class="s1">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// NOTE: Firestore functions were slightly adjusted to match best practices</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">import</span><span class="s1"> { getFirestore, doc, getDoc, addDoc, setDoc, onSnapshot, collection, query, where, serverTimestamp } </span><span class="s9">from</span><span class="s1"> </span><span class="s7">"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- GEMINI API CONSTANTS ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> </span><span class="s11">API_KEY</span><span class="s1"> = </span><span class="s7">""</span><span class="s1">;<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s4"> </span><span class="s11">MODEL_NAME</span><span class="s4"> = </span><span class="s1">"gemini-2.5-flash-preview-09-2025"</span><span class="s4">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s4"> </span><span class="s11">API_URL</span><span class="s4"> = </span><span class="s1">`https://generativelanguage.googleapis.com/v1beta/models/</span><span class="s4">${</span><span class="s11">MODEL_NAME</span><span class="s4">}</span><span class="s1">:generateContent?key=</span><span class="s4">${</span><span class="s11">API_KEY</span><span class="s4">}</span><span class="s1">`</span><span class="s4">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// ----------------------------</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- FIREBASE INITIALIZATION AND AUTHENTICATION ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.firebaseInit = </span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> firebaseConfig = </span><span class="s9">typeof</span><span class="s1"> __firebase_config !== </span><span class="s7">'undefined'</span><span class="s1"> ? </span><span class="s11">JSON</span><span class="s1">.parse(__firebase_config) : </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (firebaseConfig) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> app = initializeApp(firebaseConfig);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>window.auth = getAuth(app);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>window.db = getFirestore(app);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>setLogLevel(</span><span class="s7">'debug'</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> initialAuthToken = </span><span class="s9">typeof</span><span class="s1"> __initial_auth_token !== </span><span class="s7">'undefined'</span><span class="s1"> ? __initial_auth_token : </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (initialAuthToken) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">await</span><span class="s1"> signInWithCustomToken(window.auth, initialAuthToken);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">await</span><span class="s1"> signInAnonymously(window.auth);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>window.userId = window.auth.currentUser?.uid || crypto.randomUUID();</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// This is where the error occurred (now fixed by ensuring the element exists)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'user-id-display'</span><span class="s1">).textContent = </span><span class="s7">`User ID: </span><span class="s1">${window.userId}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// FIX: Ensure loadHistory and checkSharedPlanInURL runs ONLY after successful auth/db setup</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (window.db &amp;&amp; window.userId) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>loadHistory();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>checkSharedPlanInURL();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s7">"Firebase Auth Error:"</span><span class="s1">, error);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>window.userId = crypto.randomUUID();</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// This is where the error occurred (now fixed by ensuring the element exists)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'user-id-display'</span><span class="s1">).textContent = </span><span class="s7">`User ID: </span><span class="s1">${window.userId}</span><span class="s7"> (Anon Error)`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console.warn(</span><span class="s1">"Firebase config not found. Running in standalone mode."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>window.userId = crypto.randomUUID();</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// This is where the error occurred (now fixed by ensuring the element exists)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'user-id-display'</span><span class="s1">).textContent = </span><span class="s7">`User ID: </span><span class="s1">${window.userId}</span><span class="s7"> (Anon Error)`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>checkSharedPlanInURL();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener(</span><span class="s7">'load'</span><span class="s1">, window.firebaseInit);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- FIREBASE HISTORY FUNCTIONS ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> </span><span class="s11">USER_PLANS_PATH</span><span class="s1"> = </span><span class="s7">`artifacts/</span><span class="s1">${appId}</span><span class="s7">/users/`</span><span class="s1">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// FIX: Added 'data' segment to ensure an odd number of segments for public collection reference</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s4"> </span><span class="s11">PUBLIC_PLANS_PATH</span><span class="s4"> = </span><span class="s1">`artifacts/</span><span class="s4">${appId}</span><span class="s1">/public/data/plans`</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Loads the user's past plan history in real-time.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> loadHistory() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.db || !window.userId) </span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> plansRef = collection(window.db, </span><span class="s11">USER_PLANS_PATH</span><span class="s1">, window.userId, </span><span class="s7">'plans'</span><span class="s1">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Note: Firebase `orderBy` requires an index, we sort client-side for simplicity</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> q = query(plansRef);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>onSnapshot(q, (snapshot) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> plans = [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>snapshot.forEach((doc) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> data = doc.data();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>plans.push({ id: doc.id, ...data });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Sort client-side by creation date (newest first)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>plans.sort((a, b) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> dateA = a.createdAt ? a.createdAt.toDate().getTime() : </span><span class="s12">0</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> dateB = b.createdAt ? b.createdAt.toDate().getTime() : </span><span class="s12">0</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">return</span><span class="s1"> dateB - dateA;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderHistoryList(plans);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}, (error) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"Error loading history:"</span><span class="s1">, error);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s1">'history-list'</span><span class="s4">).innerHTML = </span><span class="s1">'&lt;p class="text-red-500"&gt;Failed to load history.&lt;/p&gt;'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Saves the current generated plan to the user's private history.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.savePlanToHistory = </span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Check that a plan exists AND Firebase is ready</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.currentPlan || !window.currentPlanDetails || !window.db || !window.userId) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Error: Please generate a plan and ensure the app is fully connected to the database before saving."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> plansCollectionRef = collection(window.db, </span><span class="s11">USER_PLANS_PATH</span><span class="s1">, window.userId, </span><span class="s7">'plans'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> saveButton = document.getElementById(</span><span class="s7">'save-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>saveButton.disabled = </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">await</span><span class="s1"> addDoc(plansCollectionRef, {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>...window.currentPlanDetails, </span><span class="s8">// prompt, duration, verse count, options</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>planData: </span><span class="s11">JSON</span><span class="s1">.stringify(window.currentPlan), </span><span class="s8">// Save plan data as string</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>createdAt: serverTimestamp(),</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>isShared: </span><span class="s9">false</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>saveButton.textContent = </span><span class="s7">'Plan Saved!'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>saveButton.textContent = </span><span class="s7">'Save to History'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>saveButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}, </span><span class="s12">3000</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"Error saving plan:"</span><span class="s1">, error);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Failed to save plan to history."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>saveButton.textContent = </span><span class="s7">'Save to History (Error)'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>saveButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Shares the current plan by saving it to a public collection and generating a link.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.sharePlan = </span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s1">// Check that a plan exists AND Firebase is ready</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.currentPlan || !window.currentPlanDetails || !window.db) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Error: Please generate a plan and ensure the app is fully connected to the database before sharing."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> publicPlansRef = collection(window.db, </span><span class="s11">PUBLIC_PLANS_PATH</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> shareButton = document.getElementById(</span><span class="s7">'share-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>shareButton.disabled = </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>shareButton.textContent = </span><span class="s7">'Generating Link...'</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 1. Save plan to public collection</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> newDocRef = doc(publicPlansRef);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> planId = newDocRef.id;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">await</span><span class="s1"> setDoc(newDocRef, {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>...window.currentPlanDetails,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>planData: </span><span class="s11">JSON</span><span class="s1">.stringify(window.currentPlan),<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>sharedAt: serverTimestamp(),</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>userId: window.userId,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 2. Generate and copy URL</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Use a generic placeholder path to ensure the link works relative to the app origin</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> baseUrl = window.location.origin + window.location.pathname.replace(</span><span class="s6">/\/$/</span><span class="s1">, </span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> shareUrl = </span><span class="s7">`</span><span class="s1">${baseUrl}</span><span class="s7">?planId=</span><span class="s1">${planId}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>copyToClipboard(shareUrl);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>shareButton.textContent = </span><span class="s7">'Link Copied!'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>shareButton.textContent = </span><span class="s7">'Share Plan'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>shareButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}, </span><span class="s12">3000</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"Error sharing plan:"</span><span class="s1">, error);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>displayError(</span><span class="s7">"Failed to share plan."</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>shareButton.textContent = </span><span class="s7">'Share Plan (Error)'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>shareButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- VIEWING SHARED PLANS ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Checks the URL for a planId parameter and loads the plan if found.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> checkSharedPlanInURL() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> params = </span><span class="s9">new</span><span class="s1"> </span><span class="s11">URLSearchParams</span><span class="s1">(window.location.search);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> planId = params.</span><span class="s9">get</span><span class="s1">(</span><span class="s7">'planId'</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (planId) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'input-card'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).textContent = </span><span class="s7">`Loading shared plan ID: </span><span class="s1">${planId}</span><span class="s7">...`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// document.getElementById('history-sidebar').classList.add('hidden'); // Removed as sidebar is now a footer item</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>loadSharedPlan(planId);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Fetches and displays a public shared plan.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1"> loadSharedPlan(planId) {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// FIX: Use a simple check here since firebaseInit ensures window.db is eventually set</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.db) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Database initialization is pending. Please wait a moment and refresh."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// FIX: Reference the public plans collection using the corrected path</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> docRef = doc(window.db, </span><span class="s11">PUBLIC_PLANS_PATH</span><span class="s1">, planId);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> docSnap = </span><span class="s9">await</span><span class="s1"> getDoc(docRef);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">if</span><span class="s1"> (docSnap.exists()) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> data = docSnap.data();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> parsedPlan = </span><span class="s11">JSON</span><span class="s1">.parse(data.planData);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Set global details for printing</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>window.currentPlan = parsedPlan;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>window.currentPlanDetails = data;<span class="Apple-converted-space"> </span></span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).textContent = </span><span class="s7">`Shared Reading Plan: </span><span class="s1">${data.prompt}</span><span class="s7"> (</span><span class="s1">${data.duration}</span><span class="s7"> Days)`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>renderPlan(parsedPlan);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">); </span><span class="s8">// Hide share/save for shared view</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>displayError(</span><span class="s7">`Shared plan ID "</span><span class="s1">${planId}</span><span class="s7">" not found.`</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"Error loading shared plan:"</span><span class="s1">, error);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Failed to load the shared plan. Check the URL and try again."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">finally</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- UI RENDER FUNCTIONS ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Renders the user's history list in the sidebar.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> renderHistoryList(plans) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> listContainer = document.getElementById(</span><span class="s7">'history-list'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>listContainer.innerHTML = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (plans.length === </span><span class="s12">0</span><span class="s1">) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>listContainer.innerHTML = </span><span class="s1">'&lt;p class="text-sm text-gray-500 p-2"&gt;No saved plans yet. Generate and save one!&lt;/p&gt;'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>plans.forEach(plan =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> date = plan.createdAt ? plan.createdAt.toDate().toLocaleDateString() : </span><span class="s7">'N/A'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> listItem = document.createElement(</span><span class="s7">'div'</span><span class="s1">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>listItem.className = </span><span class="s1">'p-3 bg-white hover:bg-gray-100 border-b border-gray-200 cursor-pointer rounded-lg mb-1 transition duration-150 shadow-sm'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>listItem.innerHTML = </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;p class="text-sm font-semibold text-primary-teal"&gt;</span><span class="s4">${plan.prompt}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;p class="text-xs text-gray-500"&gt;</span><span class="s4">${plan.duration}</span><span class="s1"> Days - </span><span class="s4">${date}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>listItem.onclick = () =&gt; loadPlanFromHistory(plan);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>listContainer.appendChild(listItem);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Loads and displays a plan saved in the user's history.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> loadPlanFromHistory(plan) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> parsedPlan = </span><span class="s11">JSON</span><span class="s1">.parse(plan.planData);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Set global details for saving/sharing metadata</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>window.currentPlan = parsedPlan;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>window.currentPlanDetails = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span>prompt: plan.prompt,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span>duration: plan.duration,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span>maxVerses: plan.maxVerses,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span>includePrompts: plan.includePrompts,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span>includePrayer: plan.includePrayer,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Update input fields to reflect the loaded plan's details</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'prompt'</span><span class="s1">).value = plan.prompt || </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'duration'</span><span class="s1">).value = plan.duration || </span><span class="s7">'7'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'max-verses'</span><span class="s1">).value = plan.maxVerses || </span><span class="s7">'1'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'journal-prompts'</span><span class="s1">).checked = plan.includePrompts || </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'prayer-prompt'</span><span class="s1">).checked = plan.includePrayer || </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).textContent = </span><span class="s7">`Loaded from History: </span><span class="s1">${plan.prompt}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Ensure generation card is visible if loading from history</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'input-card'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderPlan(parsedPlan);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Re-enable save/share buttons</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'save-button'</span><span class="s1">).textContent = </span><span class="s7">'Save to History'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'save-button'</span><span class="s1">).disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"Failed to load plan from history:"</span><span class="s1">, e);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Failed to load this plan due to data corruption."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- UTILITY FUNCTIONS ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Utility function to safely extract JSON array/object from text, handling pre-text and wrappers.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> extractJson(text) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> jsonString = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Try to find content within a markdown block first (safest method)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> match = text.match(</span><span class="s6">/```json\s*([\s\S]*?)\s*```/</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (match) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>jsonString = match[</span><span class="s12">1</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!jsonString) {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 2. Fallback: Search for the first '[' and last ']' to extract the JSON array.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> firstBracket = text.indexOf(</span><span class="s7">'['</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> lastBracket = text.lastIndexOf(</span><span class="s7">']'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">if</span><span class="s1"> (firstBracket !== -</span><span class="s12">1</span><span class="s1"> &amp;&amp; lastBracket !== -</span><span class="s12">1</span><span class="s1"> &amp;&amp; lastBracket &gt; firstBracket) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>jsonString = text.substring(firstBracket, lastBracket + </span><span class="s12">1</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (jsonString) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Try to parse the cleaned JSON string</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">return</span><span class="s1"> </span><span class="s11">JSON</span><span class="s1">.parse(jsonString.trim());</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s9">catch</span><span class="s1"> (e) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s1">"Failed to parse extracted JSON string:"</span><span class="s4">, e);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// ADDED console.error for problematic JSON snippet</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s7">"Problematic JSON snippet:"</span><span class="s1">, jsonString.trim().substring(</span><span class="s12">0</span><span class="s1">, </span><span class="s12">200</span><span class="s1">) + </span><span class="s7">'...'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">return</span><span class="s1"> </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">return</span><span class="s1"> </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Utility function for exponential backoff retry logic (kept for completeness)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1"> fetchWithRetry(url, options, retries = </span><span class="s12">3</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s9">for</span><span class="s1"> (</span><span class="s9">let</span><span class="s1"> i = </span><span class="s12">0</span><span class="s1">; i &lt; retries; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> response = </span><span class="s9">await</span><span class="s1"> fetch(url, options);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (!response.ok) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">throw</span><span class="s1"> </span><span class="s9">new</span><span class="s1"> </span><span class="s11">Error</span><span class="s1">(</span><span class="s7">`HTTP error! status: </span><span class="s1">${response.status}</span><span class="s7">`</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">return</span><span class="s1"> response;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.warn(</span><span class="s7">`Attempt </span><span class="s1">${i + </span><span class="s12">1</span><span class="s1">}</span><span class="s7"> failed.`</span><span class="s1">, error);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (i === retries - </span><span class="s12">1</span><span class="s1">) </span><span class="s9">throw</span><span class="s1"> error;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> delay = </span><span class="s11">Math</span><span class="s1">.pow(</span><span class="s12">2</span><span class="s1">, i) * </span><span class="s12">1000</span><span class="s1"> + </span><span class="s11">Math</span><span class="s1">.random() * </span><span class="s12">1000</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">await</span><span class="s1"> </span><span class="s9">new</span><span class="s1"> </span><span class="s11">Promise</span><span class="s1">(resolve =&gt; setTimeout(resolve, delay));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Copies text to the clipboard using the older document.execCommand approach</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* which is more reliable in various sandbox environments.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> copyToClipboard(text) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> textarea = document.createElement(</span><span class="s7">'textarea'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>textarea.value = text;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>textarea.style.position = </span><span class="s7">'fixed'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>textarea.style.left = </span><span class="s7">'-9999px'</span><span class="s1">; </span><span class="s8">// Move off-screen</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.body.appendChild(textarea);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>textarea.focus();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>textarea.select();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.execCommand(</span><span class="s7">'copy'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (err) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">'Copy failed:'</span><span class="s1">, err);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.body.removeChild(textarea);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- RENDER &amp; DISPLAY FUNCTIONS ---</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> displayError(message) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'error-text'</span><span class="s1">).textContent = message;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'error-message'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'generate-button'</span><span class="s1">).disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'spinner'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'print-options'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> renderPlan(planData) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> outputDiv = document.getElementById(</span><span class="s7">'plan-output'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>outputDiv.innerHTML = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'error-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!planData || planData.length === </span><span class="s12">0</span><span class="s1">) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>outputDiv.innerHTML = </span><span class="s1">'&lt;p class="text-center text-gray-500 p-8 bg-white rounded-xl shadow-lg"&gt;The AI did not generate a plan. Please try a different prompt.&lt;/p&gt;'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'print-options'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Show post-generation options</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'print-options'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> html = planData.map(day =&gt; </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-xl shadow-md transition duration-300 hover:shadow-lg"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-xl font-bold text-primary-teal mb-2"&gt;Day </span><span class="s4">${day.day}</span><span class="s1">: </span><span class="s4">${day.theme}</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;p class="text-base text-dark-teal bg-gray-100 inline-block px-3 py-1 rounded-full shadow-inner mb-4"&gt;</span><span class="s4">${day.scripture}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;!-- Display Prayer Prompt --&gt;</span></p>
<p class="p5"><span class="s7"><span class="Apple-converted-space">                    </span></span><span class="s1">${day.prayerPrompt ? </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-4 bg-gray-50 p-4 rounded-lg border-l-4 border-dark-teal"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="font-semibold text-dark-teal mb-1 flex items-center"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;path d="M10 2a3 3 0 00-3 3v2a3 3 0 006 0V5a3 3 0 00-3-3zM3 8a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM4 11a1 1 0 011-1h10a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4z"/&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/svg&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>Daily Prayer Prompt:</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-800 text-sm"&gt;</span><span class="s4">${day.prayerPrompt}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s4"> : </span><span class="s1">''</span><span class="s4">}</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s7"><span class="Apple-converted-space">                    </span></span><span class="s1">${day.reflectionQuestions &amp;&amp; day.reflectionQuestions.length &gt; </span><span class="s12">0</span><span class="s1"> ? </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="font-semibold text-gray-700 mb-2 flex items-center"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-secondary-gold" viewBox="0 0 20 20" fill="currentColor"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.868.504l-3.232 5.044A1 1 0 007 16h6a1 1 0 00.1-1.552l-3.232-5.044A1 1 0 0010 7z" clip-rule="evenodd" /&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/svg&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>Journal Prompts:</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ul class="list-disc pl-5 space-y-1 text-gray-600 text-sm"&gt;</span></p>
<p class="p5"><span class="s7"><span class="Apple-converted-space">                                </span></span><span class="s1">${day.reflectionQuestions.map(q =&gt; </span><span class="s7">`&lt;li&gt;</span><span class="s1">${q}</span><span class="s7">&lt;/li&gt;`</span><span class="s1">).join(</span><span class="s7">''</span><span class="s1">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s4"> : </span><span class="s1">''</span><span class="s4">}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">).join(</span><span class="s1">''</span><span class="s4">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>outputDiv.innerHTML = html;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- PRINTING FUNCTIONS (KEPT SAME) ---</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.printSimplePlan = </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.currentPlan || !window.currentPlanDetails) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"No plan generated yet to print."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> promptText = window.currentPlanDetails.prompt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> durationText = window.currentPlanDetails.duration;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> printContent = </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="printable-content p-8"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h1 style="text-align: center; color: #008080; font-size: 24px; font-weight: bold; margin-bottom: 5px;"&gt;BIBLEPLAN.AI Reading Plan&lt;/h1&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h2 style="text-align: center; color: #555; font-size: 16px; margin-bottom: 20px;"&gt;Topic: </span><span class="s4">${promptText}</span><span class="s1"> (</span><span class="s4">${durationText}</span><span class="s1"> Days)&lt;/h2&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.currentPlan.forEach(day =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> prayerHtml = day.prayerPrompt<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>? </span><span class="s1">`&lt;p style="font-weight: bold; color: #008080; margin-top: 15px;"&gt;Prayer Prompt:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;p style="color: #444; margin-bottom: 5px;"&gt;</span><span class="s4">${day.prayerPrompt}</span><span class="s1">&lt;/p&gt;`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>: </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> questionsHtml = day.reflectionQuestions &amp;&amp; day.reflectionQuestions.length &gt; </span><span class="s12">0</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>? </span><span class="s1">`&lt;p style="font-weight: bold; color: #333; margin-top: 15px;"&gt;Journal Prompts:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;ul style="list-style-type: disc; margin-left: 20px; color: #555;"&gt;</span></p>
<p class="p5"><span class="s7"><span class="Apple-converted-space">                           </span></span><span class="s1">${day.reflectionQuestions.map(q =&gt; </span><span class="s7">`&lt;li&gt;</span><span class="s1">${q}</span><span class="s7">&lt;/li&gt;`</span><span class="s1">).join(</span><span class="s7">''</span><span class="s1">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/ul&gt;`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>: </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// NOTE: Passage text is ALWAYS included in printout for the detailed print view</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>printContent += </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 8px;"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h3 style="color: #008080; font-size: 18px; font-weight: bold; margin-bottom: 5px;"&gt;Day </span><span class="s4">${day.day}</span><span class="s1">: </span><span class="s4">${day.theme}</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p style="color: #FFD700; font-weight: 600; font-size: 14px; margin-bottom: 10px;"&gt;Scripture: </span><span class="s4">${day.scripture}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p style="color: #444; font-style: italic; white-space: pre-wrap; margin-bottom: 10px; line-height: 1.5;"&gt;</span><span class="s4">${day.passageText}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s4">${prayerHtml}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s4">${questionsHtml}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="break-after"&gt;&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printContent += </span><span class="s7">`&lt;/div&gt;`</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> printWindow = window.open(</span><span class="s7">''</span><span class="s1">, </span><span class="s7">''</span><span class="s1">, </span><span class="s7">'height=600,width=800'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.document.write(</span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;html&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;head&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;title&gt;Simple Reading Plan Printout&lt;/title&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;style&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>/* Styles for Simple Printout */</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>@media print {</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h1, h2, h3, p, ul, li { margin: 0; padding: 0; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h1 { font-size: 24pt; color: #008080; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h2 { font-size: 14pt; color: #555; margin-bottom: 20px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h3 { font-size: 16pt; color: #008080; margin-top: 10px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>p { font-size: 10pt; color: #444; line-height: 1.5; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>li { font-size: 10pt; color: #555; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>.break-after { page-break-after: always; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>body { margin: 20px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>div[style] { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 4px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/style&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/head&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;body&gt;</span><span class="s4">${printContent}</span><span class="s1">&lt;/body&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/html&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.document.close();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.print();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.printHabitTracker = </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!window.currentPlan || !window.currentPlanDetails) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"No plan generated yet to print."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> promptText = window.currentPlanDetails.prompt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> durationText = window.currentPlanDetails.duration;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> includePrayer = window.currentPlanDetails.includePrayer; </span><span class="s8">// Use stored detail</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> tableRows = window.currentPlan.map(day =&gt; </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;</span><span class="s4">${day.day}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;</span><span class="s4">${day.theme}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;</span><span class="s4">${day.scripture}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s4">${includePrayer ? </span><span class="s1">'&lt;td&gt;&lt;/td&gt;'</span><span class="s4"> : </span><span class="s1">''</span><span class="s4">}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">).join(</span><span class="s1">''</span><span class="s4">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> prayerHeader = includePrayer ? </span><span class="s7">'&lt;th style="width: 10%;"&gt;Prayed?&lt;/th&gt;'</span><span class="s1"> : </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> printContent = </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="printable-content p-8"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h1 style="text-align: center; color: #008080; font-size: 24px; font-weight: bold; margin-bottom: 5px;"&gt;BIBLEPLAN.AI Habit Tracker&lt;/h1&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h2 style="text-align: center; color: #555; font-size: 16px; margin-bottom: 20px;"&gt;Topic: </span><span class="s4">${promptText}</span><span class="s1"> (</span><span class="s4">${durationText}</span><span class="s1"> Days)&lt;/h2&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;table class="tracker-table" style="width: 100%; border-collapse: collapse; margin-top: 20px;"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;thead&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;tr style="background-color: #f0f0f0;"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th style="width: 10%;"&gt;Day&lt;/th&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th style="width: 25%;"&gt;Theme&lt;/th&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th style="width: 35%;"&gt;Scripture&lt;/th&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th style="width: 10%;"&gt;Read?&lt;/th&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th style="width: 10%;"&gt;Journal?&lt;/th&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s4">${prayerHeader}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/tr&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/thead&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tbody&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s4">${tableRows}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tbody&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> printWindow = window.open(</span><span class="s7">''</span><span class="s1">, </span><span class="s7">''</span><span class="s1">, </span><span class="s7">'height=600,width=800'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.document.write(</span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;html&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;head&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;title&gt;Habit Tracker Printout&lt;/title&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;style&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>/* Styles for Habit Tracker Printout */</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>@media print {</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h1, h2 { margin: 0; padding: 0; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h1 { font-size: 24pt; color: #008080; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>h2 { font-size: 14pt; color: #555; margin-bottom: 20px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>.tracker-table {</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>width: 100%;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>border-collapse: collapse;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>margin-top: 20px;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>.tracker-table th, .tracker-table td {</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>border: 1px solid #333;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>padding: 8px;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>text-align: left;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>font-size: 10pt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>.tracker-table th {</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>background-color: #f0f0f0;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>body { margin: 20px; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/style&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/head&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;body&gt;</span><span class="s4">${printContent}</span><span class="s1">&lt;/body&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/html&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.document.close();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>printWindow.print();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- SCREENSHOT FUNCTION ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.screenshotPlan = </span><span class="s9">function</span><span class="s1">() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> planOutput = document.getElementById(</span><span class="s7">'results-area'</span><span class="s1">);<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> screenshotButton = document.getElementById(</span><span class="s7">'screenshot-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> originalButtonText = screenshotButton.textContent;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!planOutput || !window.currentPlan) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"No plan generated to screenshot yet."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>screenshotButton.disabled = </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>screenshotButton.textContent = </span><span class="s7">'Processing...'</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Generate the minimalist HTML content (Day and Scripture only)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> minimalistHtml = </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div style="padding: 20px; background-color: #ffffff; font-family: sans-serif; font-size: 16px;"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h1 style="color: #006666; font-size: 24px; font-weight: bold; margin-bottom: 15px;"&gt;Bible Plan: </span><span class="s4">${window.currentPlanDetails.prompt}</span><span class="s1">&lt;/h1&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;table style="width: 100%; border-collapse: collapse;"&gt;</span></p>
<p class="p5"><span class="s7"><span class="Apple-converted-space">                        </span></span><span class="s1">${window.currentPlan.map(day =&gt; </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;tr style="border-bottom: 1px solid #ddd;"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td style="padding: 8px 0; width: 30%; color: #008080; font-weight: bold;"&gt;Day </span><span class="s4">${day.day}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td style="padding: 8px 0; width: 70%; color: #006666;"&gt;</span><span class="s4">${day.scripture}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/tr&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>`</span><span class="s4">).join(</span><span class="s1">''</span><span class="s4">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 2. Create a temporary container for html2canvas</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> tempDiv = document.createElement(</span><span class="s7">'div'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>tempDiv.innerHTML = minimalistHtml;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>tempDiv.style.position = </span><span class="s7">'fixed'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>tempDiv.style.top = </span><span class="s7">'-9999px'</span><span class="s1">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.body.appendChild(tempDiv);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 3. Capture the temporary div</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>html2canvas(tempDiv, {<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>allowTaint: </span><span class="s9">true</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>useCORS: </span><span class="s9">true</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>scale: </span><span class="s12">2</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}).then(canvas =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> base64image = canvas.toDataURL(</span><span class="s7">'image/png'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Create a temporary link element for downloading</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> link = document.createElement(</span><span class="s7">'a'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> planName = window.currentPlanDetails.prompt || </span><span class="s7">'BiblePlan'</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>link.download = </span><span class="s7">`BiblePlan_Simple_</span><span class="s1">${planName.replace(</span><span class="s6">/[^a-zA-Z0-9]/</span><span class="s9">g</span><span class="s1">, </span><span class="s7">'_'</span><span class="s1">).substring(</span><span class="s12">0</span><span class="s1">, </span><span class="s12">20</span><span class="s1">)}</span><span class="s7">.png`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>link.href = base64image;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Trigger the download</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.body.appendChild(link);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>link.click();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.body.removeChild(link);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Cleanup temporary div</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.body.removeChild(tempDiv);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>screenshotButton.textContent = </span><span class="s7">'Saved!'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>screenshotButton.textContent = originalButtonText;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>screenshotButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}, </span><span class="s12">3000</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}).</span><span class="s9">catch</span><span class="s1">(error =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">'Screenshot failed:'</span><span class="s1">, error);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Cleanup temporary div if it exists</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">if</span><span class="s1"> (tempDiv.parentNode) document.body.removeChild(tempDiv);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">'Failed to capture image. Try printing instead.'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>screenshotButton.textContent = originalButtonText;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>screenshotButton.disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- MAIN GENERATION LOGIC ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>window.generatePlan = </span><span class="s9">async</span><span class="s1"> </span><span class="s9">function</span><span class="s1">(event) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>event.preventDefault();</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// FIX: Reset currentPlan and currentPlanDetails to ensure the save/share logic knows no valid plan exists yet</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.currentPlan = </span><span class="s9">null</span><span class="s1">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.currentPlanDetails = </span><span class="s9">null</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> prompt = document.getElementById(</span><span class="s7">'prompt'</span><span class="s1">).value.trim();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> duration = document.getElementById(</span><span class="s7">'duration'</span><span class="s1">).value;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> verseCount = document.getElementById(</span><span class="s7">'max-verses'</span><span class="s1">).value;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> includePrompts = document.getElementById(</span><span class="s7">'journal-prompts'</span><span class="s1">).checked;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> includePrayer = document.getElementById(</span><span class="s7">'prayer-prompt'</span><span class="s1">).checked;<span class="Apple-converted-space"> </span></span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (!prompt || !duration || !verseCount) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">"Please fill out all required fields (Topic, Duration, and # of Verses)."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Store plan details for saving/sharing metadata</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.currentPlanDetails = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>prompt, duration, maxVerses: verseCount, includePrompts, includePrayer</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// UI State: Loading</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'error-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'plan-output'</span><span class="s1">).innerHTML = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'generate-button'</span><span class="s1">).disabled = </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'spinner'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'print-options'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'share-save-container'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Dynamically build the plan type description</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> components = [</span><span class="s7">'daily scripture reading'</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (includePrompts) components.push(</span><span class="s7">'reflection, and journal prompts'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (includePrayer) components.push(</span><span class="s7">'a prayer prompt'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> planType = components.filter(</span><span class="s11">Boolean</span><span class="s1">).join(</span><span class="s7">', '</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>planType = planType.replace(</span><span class="s6">/,([^,]*)$/</span><span class="s1">, </span><span class="s7">' and$1'</span><span class="s1">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// NOTE: The system prompt remains the same, ensuring full passage text is generated for printing/saving.</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s4"> systemPrompt = </span><span class="s1">`You are a world-class, deeply knowledgeable theological assistant specializing in creating structured, daily Bible reading and reflection plans. Your task is to generate a comprehensive </span><span class="s4">${planType}</span><span class="s1"> based on the user's request.</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>1. Theme/Topic: The plan must be focused on the user's specific input: "</span><span class="s4">${prompt}</span><span class="s1">".</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>2. Duration: The plan must cover exactly </span><span class="s4">${duration}</span><span class="s1"> days.</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>3. Scripture &amp; Passage Text: Provide highly relevant, specific scripture references (Book Chapter:Verse-Verse). Crucially, include the full, corresponding text of the passage. The total reading for the day must consist of passages that sum up to **approximately </span><span class="s4">${verseCount}</span><span class="s1"> verses**. These passages should be drawn from **multiple, non-contiguous references** across the Bible to provide a broad theological view of the theme.</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>4. Reflection: If requested, generate 2-3 thoughtful, non-generic reflection questions or journal prompts per day that encourage deep engagement with the scripture.</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>5. Prayer: If requested, generate a concise, focused prayer prompt (a short sentence or two) for each day, related to the reading. If not requested, ensure the 'prayerPrompt' field is an empty string.</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>6. Output: Your response MUST be a JSON array of objects conforming exactly to the provided schema. DO NOT include any text outside the JSON block.`</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s4"> userQuery = </span><span class="s1">`Create a </span><span class="s4">${duration}</span><span class="s1">-day Bible reading plan focused on the topic: "</span><span class="s4">${prompt}</span><span class="s1">". The reading for each day must be composed of **multiple passages** whose total length is **approximately </span><span class="s4">${verseCount}</span><span class="s1"> verses**. For each day, provide the scripture reference(s) AND the combined full passage text. </span><span class="s4">${includePrompts ? </span><span class="s1">'Include relevant reflection questions/journal prompts.'</span><span class="s4"> : </span><span class="s1">'Do not include reflection questions.'</span><span class="s4">}</span><span class="s1"> </span><span class="s4">${includePrayer ? </span><span class="s1">'Include a concise prayer prompt for each day.'</span><span class="s4"> : </span><span class="s1">'Do not include a prayer prompt.'</span><span class="s4">}</span><span class="s1">`</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> responseSchema = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>type: </span><span class="s7">"ARRAY"</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>items: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>type: </span><span class="s7">"OBJECT"</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>properties: {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">"day"</span><span class="s4">: { </span><span class="s1">"type"</span><span class="s4">: </span><span class="s1">"INTEGER"</span><span class="s4">, </span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"The day number in the reading plan (1, 2, 3, etc.)."</span><span class="s4"> },</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">"theme"</span><span class="s4">: { </span><span class="s1">"type"</span><span class="s4">: </span><span class="s1">"STRING"</span><span class="s4">, </span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"A short, descriptive theme or title for the day's reading."</span><span class="s4"> },</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">"scripture"</span><span class="s4">: { </span><span class="s1">"type"</span><span class="s4">: </span><span class="s1">"STRING"</span><span class="s4">, </span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"The specific Bible reference(s) for the reading (e.g., 'Genesis 1:1-2:3, Psalm 23:1-6')."</span><span class="s4"> },</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">"passageText"</span><span class="s4">: { </span><span class="s1">"type"</span><span class="s4">: </span><span class="s1">"STRING"</span><span class="s4">, </span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"The combined full text of the corresponding scripture passages for the day."</span><span class="s4"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">"reflectionQuestions"</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">"type"</span><span class="s1">: </span><span class="s7">"ARRAY"</span><span class="s1">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"A list of 2-3 reflection questions or journal prompts. If the user did not request prompts, this array should be empty."</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">"items"</span><span class="s1">: { </span><span class="s7">"type"</span><span class="s1">: </span><span class="s7">"STRING"</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">"prayerPrompt"</span><span class="s4">: { </span><span class="s1">"type"</span><span class="s4">: </span><span class="s1">"STRING"</span><span class="s4">, </span><span class="s1">"description"</span><span class="s4">: </span><span class="s1">"A concise prayer prompt related to the day's theme. Use an empty string if not requested."</span><span class="s4"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>required: [</span><span class="s1">"day"</span><span class="s4">, </span><span class="s1">"theme"</span><span class="s4">, </span><span class="s1">"scripture"</span><span class="s4">, </span><span class="s1">"passageText"</span><span class="s4">, </span><span class="s1">"reflectionQuestions"</span><span class="s4">, </span><span class="s1">"prayerPrompt"</span><span class="s4">]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> payload = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>contents: [{ parts: [{ text: userQuery }] }],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>systemInstruction: { parts: [{ text: systemPrompt }] },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>generationConfig: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>responseMimeType: </span><span class="s7">"application/json"</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>responseSchema: responseSchema</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> response = </span><span class="s9">await</span><span class="s1"> fetchWithRetry(</span><span class="s11">API_URL</span><span class="s1">, {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>method: </span><span class="s7">'POST'</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>headers: { </span><span class="s7">'Content-Type'</span><span class="s1">: </span><span class="s7">'application/json'</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>body: </span><span class="s11">JSON</span><span class="s1">.stringify(payload)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> result = </span><span class="s9">await</span><span class="s1"> response.json();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> candidate = result.candidates?.[</span><span class="s12">0</span><span class="s1">];</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">if</span><span class="s1"> (candidate &amp;&amp; candidate.content?.parts?.[</span><span class="s12">0</span><span class="s1">]?.text) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> jsonText = candidate.content.parts[</span><span class="s12">0</span><span class="s1">].text;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> parsedPlan = extractJson(jsonText);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (</span><span class="s11">Array</span><span class="s1">.isArray(parsedPlan)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>window.currentPlan = parsedPlan;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>renderPlan(parsedPlan);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).textContent = </span><span class="s7">`Generated Plan for: </span><span class="s1">${prompt}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>document.getElementById(</span><span class="s7">'plan-output-title'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s9">throw</span><span class="s4"> </span><span class="s9">new</span><span class="s4"> </span><span class="s11">Error</span><span class="s4">(</span><span class="s1">"Could not parse valid reading plan array from AI response."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Check for blocked content</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> finishReason = result.candidates?.[</span><span class="s12">0</span><span class="s1">]?.finishReason;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1"> (finishReason &amp;&amp; finishReason.includes(</span><span class="s7">'SAFETY'</span><span class="s1">)) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s9">throw</span><span class="s4"> </span><span class="s9">new</span><span class="s4"> </span><span class="s11">Error</span><span class="s4">(</span><span class="s1">"Generation blocked due to safety settings. Please try a different prompt."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s9">else</span><span class="s1"> </span><span class="s9">if</span><span class="s1"> (finishReason) {</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s9">throw</span><span class="s4"> </span><span class="s9">new</span><span class="s4"> </span><span class="s11">Error</span><span class="s4">(</span><span class="s1">`Generation failed: Model returned non-readable text. Reason: </span><span class="s4">${finishReason}</span><span class="s1">`</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">// Throw original error for general failure</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s9">throw</span><span class="s4"> </span><span class="s9">new</span><span class="s4"> </span><span class="s11">Error</span><span class="s4">(</span><span class="s1">"AI response structure was invalid or empty (API returned no readable text)."</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.error(</span><span class="s7">"API or JSON Parsing Error:"</span><span class="s1">, error);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayError(</span><span class="s1">`Failed to generate plan: </span><span class="s4">${error.message}</span><span class="s1">. Please check your prompt and try again.`</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s9">finally</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// UI State: Done</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'loading-message'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'generate-button'</span><span class="s1">).disabled = </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'spinner'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Modernized Styles */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.card</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">/* Using a softer, deeper shadow for modern elevation */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s13">4px</span><span class="s1"> </span><span class="s13">12px</span><span class="s1"> </span><span class="s14">rgba(</span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0.08</span><span class="s14">)</span><span class="s1">, </span><span class="s13">0</span><span class="s1"> </span><span class="s13">2px</span><span class="s1"> </span><span class="s13">4px</span><span class="s1"> </span><span class="s14">rgba(</span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0.05</span><span class="s14">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s14">all</span><span class="s1"> </span><span class="s13">0.3s</span><span class="s1"> </span><span class="s14">cubic-bezier(</span><span class="s13">0.25</span><span class="s1">, </span><span class="s13">0.8</span><span class="s1">, </span><span class="s13">0.25</span><span class="s1">, </span><span class="s13">1</span><span class="s14">)</span><span class="s1">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s4"> </span><span class="s13">1px</span><span class="s4"> </span><span class="s14">solid</span><span class="s4"> </span><span class="s14">#E5E7EB</span><span class="s4">; </span><span class="s1">/* Subtle border on card */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.card:hover</span><span class="s4"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s13">6px</span><span class="s1"> </span><span class="s13">18px</span><span class="s1"> </span><span class="s14">rgba(</span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0.1</span><span class="s14">)</span><span class="s1">, </span><span class="s13">0</span><span class="s1"> </span><span class="s13">4px</span><span class="s1"> </span><span class="s13">6px</span><span class="s1"> </span><span class="s14">rgba(</span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0</span><span class="s1">, </span><span class="s13">0.08</span><span class="s14">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s14">translateY(</span><span class="s13">-1px</span><span class="s14">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.bg-gray-50</span><span class="s1"> {<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> </span><span class="s14">#F8F8F8</span><span class="s4">; </span><span class="s1">/* Softer background */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* REVERTED TO ORIGINAL VIBRANT COLORS */</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.text-primary-teal</span><span class="s4"> { </span><span class="s2">color:</span><span class="s4"> </span><span class="s14">#008080</span><span class="s4">; } </span><span class="s1">/* Primary text (teal) */</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.text-secondary-gold</span><span class="s4"> { </span><span class="s2">color:</span><span class="s4"> </span><span class="s14">#FFD700</span><span class="s4">; } </span><span class="s1">/* Accent text (gold) */</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.bg-primary-teal</span><span class="s4"> { </span><span class="s1">background-color:</span><span class="s4"> </span><span class="s14">#008080</span><span class="s4">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.bg-secondary-gold</span><span class="s4"> { </span><span class="s1">background-color:</span><span class="s4"> </span><span class="s14">#FFD700</span><span class="s4">; </span><span class="s1">color:</span><span class="s4"> </span><span class="s14">#006666</span><span class="s4">; } </span><span class="s8">/* Buttons/Accents */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.border-primary-teal</span><span class="s4"> { </span><span class="s2">border-color:</span><span class="s4"> </span><span class="s14">#008080</span><span class="s4">; }</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.border-secondary-gold</span><span class="s4"> { </span><span class="s2">border-color:</span><span class="s4"> </span><span class="s14">#FFD700</span><span class="s4">; }<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.bg-gray-100</span><span class="s4"> { </span><span class="s1">background-color:</span><span class="s4"> </span><span class="s14">#F3F4F6</span><span class="s4">; }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.text-dark-teal</span><span class="s1"> { </span><span class="s2">color:</span><span class="s1"> </span><span class="s14">#006666</span><span class="s1">; }</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Modern Button Styles */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">button</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-radius:</span><span class="s1"> </span><span class="s13">10px</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#generate-button</span><span class="s4"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s14">#008080</span><span class="s4">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#generate-button:hover</span><span class="s4"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s14">#006666</span><span class="s4">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Generated Content Styling */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#plan-output</span><span class="s4"> </span><span class="s1">.card</span><span class="s4"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border-left:</span><span class="s4"> </span><span class="s13">4px</span><span class="s4"> </span><span class="s14">solid</span><span class="s4"> </span><span class="s14">#008080</span><span class="s4">; </span><span class="s1">/* Use side border instead of top border for elegance */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-top:</span><span class="s1"> </span><span class="s14">none</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s13">20px</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#plan-output</span><span class="s4"> </span><span class="s1">h3</span><span class="s4"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s1"> </span><span class="s13">1.25rem</span><span class="s1">; </span><span class="s8">/* text-xl */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s13">600</span><span class="s1">; </span><span class="s8">/* semi-bold */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">#plan-output</span><span class="s1"> </span><span class="s6">p</span><span class="s1">[</span><span class="s14">class</span><span class="s1">*=</span><span class="s7">"text-lg"</span><span class="s1">] {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s4"> </span><span class="s13">1rem</span><span class="s4">; </span><span class="s1">/* Smaller, cleaner reference text */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s13">500</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* New: Slimmer Newsletter Box */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.newsletter-container</span><span class="s4"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">max-width:</span><span class="s4"> </span><span class="s13">480px</span><span class="s4">; </span><span class="s1">/* max-w-lg equivalent */</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s4"> </span><span class="s13">16px</span><span class="s4">; </span><span class="s1">/* p-4 equivalent */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin:</span><span class="s1"> </span><span class="s13">1.5rem</span><span class="s1"> </span><span class="s14">auto</span><span class="s1">; </span><span class="s8">/* mt-6 mb-10 */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-50 min-h-screen p-4 md:p-8 font-sans"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Main App Content Wrapper (max-w-4xl) --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-4xl mx-auto"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Main Content Area --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Updated Header --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-10"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-5xl font-extrabold tracking-tight mb-1 text-primary-teal uppercase"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>BIBLEPLAN</span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-secondary-gold"</span><span class="s3">&gt;</span><span class="s1">.AI</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- UPDATED SUBTITLE --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-lg font-medium text-gray-700 italic border-b border-gray-300 pb-4 inline-block"</span><span class="s3">&gt;</span><span class="s4">your bible reading plan generator</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Input Form Card --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"input-card"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-6 md:p-8 rounded-xl card mb-10"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold mb-6 text-primary-teal"</span><span class="s3">&gt;</span><span class="s4">Create Your Plan</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">form</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"plan-form"</span><span class="s4"> </span><span class="s2">onsubmit</span><span class="s3">=</span><span class="s1">"generatePlan(event)"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-6"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s1">&lt;!-- UPDATED LABEL: Removed specific examples --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s1"> </span><span class="s2">for</span><span class="s3">=</span><span class="s5">"prompt"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"block text-sm font-medium text-gray-700 mb-2"</span><span class="s3">&gt;</span><span class="s1">Topic or Book or Chapter, etc.</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">textarea</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"prompt"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"prompt"</span><span class="s4"> </span><span class="s2">rows</span><span class="s3">=</span><span class="s1">"2"</span><span class="s4"> </span><span class="s2">required</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-teal focus:border-primary-teal transition duration-150"</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"e.g., The Life of David, The Book of Romans, Forgiveness"</span><span class="s3">&gt;&lt;/</span><span class="s6">textarea</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">&lt;!-- Layout for Duration and # of Verses --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-2 md:grid-cols-4 gap-6"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"col-span-1"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"duration"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-700 mb-2"</span><span class="s3">&gt;</span><span class="s4">Duration (Days)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s1">&lt;!-- MAX CHANGED FROM 90 TO 40 --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"number"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"duration"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"duration"</span><span class="s4"> </span><span class="s2">required</span><span class="s4"> </span><span class="s2">min</span><span class="s3">=</span><span class="s1">"1"</span><span class="s4"> </span><span class="s2">max</span><span class="s3">=</span><span class="s1">"40"</span><span class="s4"> </span><span class="s2">value</span><span class="s3">=</span><span class="s1">"7"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-teal focus:border-primary-teal transition duration-150"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-xs text-gray-500 mt-1"</span><span class="s3">&gt;</span><span class="s1">Max 40 days.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;!-- # OF VERSES INPUT --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"col-span-1"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"max-verses"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-700 mb-2"</span><span class="s3">&gt;</span><span class="s4"># of verses/day</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"number"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"max-verses"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"max-verses"</span><span class="s4"> </span><span class="s2">required</span><span class="s4"> </span><span class="s2">min</span><span class="s3">=</span><span class="s1">"1"</span><span class="s4"> </span><span class="s2">max</span><span class="s3">=</span><span class="s1">"50"</span><span class="s4"> </span><span class="s2">value</span><span class="s3">=</span><span class="s1">"1"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-teal focus:border-primary-teal transition duration-150"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-xs text-gray-500 mt-1"</span><span class="s3">&gt;</span><span class="s1">Limit reading length.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s1">&lt;!-- Checkbox Group (Spanning the remaining two columns on desktop) --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"col-span-2 flex flex-col space-y-3 pt-6 md:pt-0"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"flex items-center"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s8">&lt;!-- REMOVED 'checked' attribute --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                    </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"checkbox"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"journal-prompts"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"journal-prompts"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-5 w-5 text-dark-teal rounded border-gray-300 focus:ring-dark-teal"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s1"> </span><span class="s2">for</span><span class="s3">=</span><span class="s5">"journal-prompts"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"ml-3 text-sm font-medium text-gray-700"</span><span class="s3">&gt;</span><span class="s1">Include Journal Prompts &amp; Reflection Questions</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s1">&lt;!-- Prayer Checkbox - REMOVED 'checked' attribute --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"flex items-center"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                    </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"checkbox"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"prayer-prompt"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"prayer-prompt"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-5 w-5 text-dark-teal rounded border-gray-300 focus:ring-dark-teal"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s1"> </span><span class="s2">for</span><span class="s3">=</span><span class="s5">"prayer-prompt"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"ml-3 text-sm font-medium text-gray-700"</span><span class="s3">&gt;</span><span class="s1">Include Daily Prayer Prompt</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"submit"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"generate-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-primary-teal text-white py-3 rounded-xl font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-primary-teal focus:ring-opacity-50 flex items-center justify-center"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">svg</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"spinner"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden"</span><span class="s4"> </span><span class="s2">xmlns</span><span class="s3">=</span><span class="s1">"http://www.w3.org/2000/svg"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"none"</span><span class="s4"> </span><span class="s2">viewBox</span><span class="s3">=</span><span class="s1">"0 0 24 24"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">circle</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-25"</span><span class="s4"> </span><span class="s2">cx</span><span class="s3">=</span><span class="s1">"12"</span><span class="s4"> </span><span class="s2">cy</span><span class="s3">=</span><span class="s1">"12"</span><span class="s4"> </span><span class="s2">r</span><span class="s3">=</span><span class="s1">"10"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"4"</span><span class="s3">&gt;&lt;/</span><span class="s6">circle</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-75"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"</span><span class="s3">&gt;&lt;/</span><span class="s6">path</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">svg</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>Generate Reading Plan</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">form</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Share &amp; Save Container --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"share-save-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-6 md:p-8 rounded-xl card mb-10 hidden"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-semibold mb-4 text-gray-700"</span><span class="s3">&gt;</span><span class="s4">Manage Plan</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 md:grid-cols-2 gap-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"save-button"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"savePlanToHistory()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-dark-teal text-white py-3 rounded-xl font-semibold hover:bg-primary-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-dark-teal focus:ring-opacity-50"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>Save to History</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"share-button"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"sharePlan()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-secondary-gold text-dark-teal py-3 rounded-xl font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-secondary-gold focus:ring-opacity-50"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>Share Plan</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Print Options (Added Screenshot button) --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"print-options"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-6 md:p-8 rounded-xl card mb-10 hidden"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-semibold mb-4 text-gray-700"</span><span class="s3">&gt;</span><span class="s4">Output Options</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 md:grid-cols-3 gap-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"screenshot-button"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"screenshotPlan()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-secondary-gold text-dark-teal py-3 rounded-xl font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-secondary-gold focus:ring-opacity-50"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>Screenshot Plan</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"printSimplePlan()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-secondary-gold text-dark-teal py-3 rounded-xl font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-secondary-gold focus:ring-opacity-50"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>Print Simple Plan (Detailed)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"printHabitTracker()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-secondary-gold text-dark-teal py-3 rounded-xl font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-secondary-gold focus:ring-opacity-50"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>Print Habit Tracker (Spreadsheet)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Results Area --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"results-area"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"loading-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center text-primary-teal font-medium hidden"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Generating your custom plan... this may take a few moments.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"error-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl hidden"</span><span class="s4"> </span><span class="s2">role</span><span class="s3">=</span><span class="s1">"alert"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s3">&gt;</span><span class="s1">Error:</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"error-text"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-sm"</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"plan-output-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-extrabold text-primary-teal mb-6 hidden"</span><span class="s3">&gt;&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"plan-output"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"space-y-6"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Generated plan will be inserted here --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s1">&lt;!-- End Main Content Area --&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s1">&lt;!-- End Main App Content Wrapper --&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- HISTORY MOVED TO BOTTOM --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-4xl mx-auto mt-12"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">aside</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"history-sidebar"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-6 rounded-xl shadow-lg border border-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-bold text-dark-teal mb-4 flex items-center"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">svg</span><span class="s4"> </span><span class="s2">xmlns</span><span class="s3">=</span><span class="s1">"http://www.w3.org/2000/svg"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-6 w-6 mr-2"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"none"</span><span class="s4"> </span><span class="s2">viewBox</span><span class="s3">=</span><span class="s1">"0 0 24 24"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"2"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">stroke-linecap</span><span class="s3">=</span><span class="s1">"round"</span><span class="s4"> </span><span class="s2">stroke-linejoin</span><span class="s3">=</span><span class="s1">"round"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"</span><span class="s4"> </span><span class="s3">/&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">svg</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Plan History</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"history-list"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"space-y-2 max-h-[40vh] overflow-y-auto"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-sm text-gray-500 p-2"</span><span class="s3">&gt;</span><span class="s1">Loading plans...</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- FIX: Re-added the missing user-id-display element --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"user-id-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xs text-gray-400 mt-4 pt-2 border-t"</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">aside</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- END HISTORY --&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Footer content --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">footer</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-12 py-4 text-center text-gray-500 border-t border-gray-300"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-sm"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>created by<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://heyjerv.beehiiv.com"</span><span class="s4"> </span><span class="s2">target</span><span class="s3">=</span><span class="s1">"_blank"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-primary-teal hover:text-dark-teal font-semibold"</span><span class="s3">&gt;</span><span class="s4">taylor jervis</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span><span class="s4">.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"mailto:heyjerv@gmail.com"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-primary-teal hover:text-dark-teal font-semibold"</span><span class="s3">&gt;</span><span class="s4">contact</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span><span class="s4"> for help or to say hi.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">footer</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Newsletter Signup Section (MOVED TO VERY BOTTOM) --&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- SLIMMER VERSION --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"newsletter-container bg-white rounded-xl shadow-lg border border-gray-200 p-4 mx-auto mt-6 mb-10"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center text-gray-700 mb-4 text-sm font-semibold"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>Subscribe for weekly devos from the creator</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Beehiiv Form Start --&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- IMPORTANT: You MUST replace the 'action' URL and the 'name'/'value' fields below with the exact data from your Beehiiv form embed code. --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">form</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"beehiiv-form"</span><span class="s4"> </span><span class="s2">action</span><span class="s3">=</span><span class="s1">"[PASTE YOUR BEEHIIV FORM SUBMISSION URL HERE]"</span><span class="s4"> </span><span class="s2">method</span><span class="s3">=</span><span class="s1">"post"</span><span class="s4"> </span><span class="s2">target</span><span class="s3">=</span><span class="s1">"_blank"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col md:flex-row gap-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">type</span><span class="s3">=</span><span class="s5">"email"</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">name</span><span class="s3">=</span><span class="s5">"email"</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">id</span><span class="s3">=</span><span class="s5">"email-input"</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Your Email Address"</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">required</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">aria-label</span><span class="s3">=</span><span class="s1">"Email subscription"</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-grow p-2.5 border border-gray-300 rounded-lg text-sm focus:ring-primary-teal focus:border-primary-teal transition duration-150"</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Beehiiv often requires hidden fields for security/form ID. Paste them here if provided. --&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- &lt;input type="hidden" name="xyz" value="123"&gt; --&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">type</span><span class="s3">=</span><span class="s5">"submit"</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full md:w-auto bg-primary-teal text-white py-2.5 px-6 rounded-lg text-sm font-semibold hover:bg-dark-teal transition duration-300 focus:outline-none focus:ring-4 focus:ring-primary-teal focus:ring-opacity-50"</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Subscribe</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">form</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Beehiiv Form End --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- END Newsletter Signup Section --&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
</body>
</html>
